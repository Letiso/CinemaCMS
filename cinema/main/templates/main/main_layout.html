{% load static i18n %}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"
          name="viewport"
          content="width=device-width, initial-scale=1">
    {% block meta %}

    {% endblock %}
    <title>
        {% block title %}

        {% endblock %}
    </title>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="{% static 'plugins/fontawesome-free/css/all.min.css' %}">
    <!-- Bootstrap core CSS -->
    <link href="{% static 'dist/css/bootstrap.min.css' %}" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{% static 'main/main_layout/css/main_layout.css' %}">

    {% block stylesheets %}

    {% endblock %}
  </head>

  <body>
    {% block top_banner %}

    {% endblock %}
    <!-- Navbar-->
    <nav class="nav navbar-default navbar-expand-lg navbar-light bg-dark pt-2">

      <div class="navbar col-lg-2">
        <img src="{% static 'main/main_layout/img/logo.png' %}"
             class="rounded logo mx-auto"
             alt="Лого">
        <button class="navbar-toggler mr-4"
                type="button"
                data-toggle="collapse"
                data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
      </div>

      <div class="nav collapse navbar-collapse ml-5 ml-lg-0"
           id="navbarSupportedContent">
        <div class="col-12 navbar">
          <ul class="navbar-nav my-2 my-lg-0 mx-auto">
            <li class="nav-item ml-auto ">
              <form class="form-inline mr-lg-1">
                <input class="form-control navbar-item mr-2"
                       type="search"
                       placeholder="{% trans 'Search' %}"
                       aria-label="Search">
                <button class="btn btn-outline-success"
                        type="submit">
                    {% trans 'Search' %}
                </button>
              </form>
            </li>
          </ul>
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <div class="nav social-links mt-3 mb-2 my-lg-0 ml-lg-3 mr-lg-2">
                <a href="#"
                   title="Facebook"><img class="link-height"
                                         src="{% static 'main/main_layout/img/social_icons/facebook.png' %}"></a>
                <a href="#"
                   title="Twitter"><img class="link-height"
                                        src="{% static 'main/main_layout/img/social_icons/twitter.png' %}"></a>
                <a href="#"
                   title="{% trans 'Vkontakte' %}"><img class="link-height"
                                          src="{% static 'main/main_layout/img/social_icons/vkontakte.png' %}"></a>
                <a href="#"
                   title="{% trans 'Odnoklassniki' %}"><img class="link-height"
                                              src="{% static 'main/main_layout/img//social_icons/odnoklassniki.png' %}"></a>
                <a href="#"
                   title="Google +"><img class="link-height"
                                         src="{% static 'main/main_layout/img/social_icons/google_plus.png' %}"></a>
              </div>
            </li>

            <li class="nav-item">
              <ul class="navbar-nav">
                <li class="nav-item dropdown">
                  <a href="#"
                     class="nav-link dropdown-toggle"
                     id="numbersDropdown"
                     role="button"
                     data-toggle="dropdown"
                     aria-haspopup="true"
                     aria-expanded="false">
                      {% trans 'Make a call' %}
                  </a>

                  <div class="dropdown-menu dropdown-menu-right"
                       aria-labelledby="langDropdown">
                      {% for phone_number in navbar_phone_numbers %}
                          {% if forloop.counter != 1 %}
                              <div class="dropdown-divider"></div>
                          {% endif %}
                          <div class="dropdown-header">
                              {% trans 'Number' %} {{ forloop.counter }}
                          </div>
                            <a class="dropdown-item"
                               href="#">{{ phone_number }}</a>
                      {% endfor %}
                  </div>
                </li></ul></li>
          </ul>
        </div>

        <div class="col-12 navbar">
          <ul class="navbar-nav mr-auto">

            <li class="nav-item {% block main_main %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:main_page' %}">
                  <i class="fas fa-home mx-2 text-light" style="font-size:23px;"></i>
              </a>
            </li>

            <li class="nav-item {% block main_poster %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:poster' %}">
                  {% trans 'Poster' %}
              </a>
            </li>

            <li class="nav-item {% block main_timetable %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:timetable' %}">
                  {% trans 'Timetable' %}
              </a>
            </li>

            <li class="nav-item {% block main_soon %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:soon' %}">
                  {% trans 'Soon' %}
              </a>
            </li>

            <li class="nav-item {% block main_cinemas %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:cinemas' %}">
                  {% trans 'Cinemas' %}
              </a>
            </li>

            <li class="nav-item {% block main_promotion %} {% endblock %}">
              <a class="nav-link"
                 href="{% url 'main:promotion' %}">
                  {% trans 'Promotions' %}
              </a>
            </li>

            <li class="nav-item {% block main_about_the_cinema %} {% endblock %}">
                <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                  <a href="{% url 'main:about_the_cinema' %}" class="nav-link">
                      {% trans 'About the cinema' %}
                  </a>

                  <div class="btn-group" role="group">
                    <a class="nav-link dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    </a>
                  <div class="dropdown-menu"
                   aria-labelledby="navbarDropdown">

                    <a class="dropdown-item"
                       href="{% url 'main:news' %}">
                        {% trans 'News' %}
                    </a>
                    <a class="dropdown-item"
                       href="{% url 'main:advertising' %}">
                        {% trans 'Advertising' %}
                    </a>

                    <div class="dropdown-divider"></div>

                    <a class="dropdown-item"
                       href="{% url 'main:cafe_bar' %}">
                        {% trans 'Cafe' %}
                    </a>
                    <a class="dropdown-item"
                       href="{% url 'main:child_room' %}">
                        {% trans 'Child room' %}
                    </a>
                      <a class="dropdown-item"
                       href="{% url 'main:vip_hall' %}">
                        VIP-{% trans 'hall' %}
                    </a>

                    <div class="dropdown-divider"></div>

                    <a class="dropdown-item"
                       href="{% url 'main:mobile_applications' %}">
                        {% trans 'Mobile applications' %}
                    </a>

                    <div class="dropdown-divider"></div>

                    <a class="dropdown-item"
                       href="{% url 'main:contacts' %}">
                        {% trans 'Contacts' %}
                    </a>
                  </div>

                  </div>

                </div>
            </li>
          </ul>

          <ul class="navbar-nav ml-auto">
            {% if not user.is_authenticated %}
              <li class="nav-item">
                <a class="nav-link"
                   href="{% url 'user:login' %}">{% trans 'Signin' %}</a>
              </li>
              <li class="nav-item">
                <a class="nav-link"
                   href="{% url 'user:signup' %}">{% trans 'Registration' %}</a>
              </li>
            {% endif %}
            {% if user.is_authenticated %}
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle"
                     href=""
                     id="userDropdown"
                     role="button"
                     data-toggle="dropdown"
                     aria-haspopup="true"
                     aria-expanded="false">
                    {% trans 'Hello, ' %}<span class="badge badge-success" style="text-decoration: none; font-size: 18px; color: #fff;">
                      {{ user.username }}
                    </span></a>

                  <div class="dropdown-menu dropdown-menu-right"
                       aria-labelledby="langDropdown">
                    <a class="dropdown-item"
                       href="{% url 'user:update_account' user.pk %}">
                        {% trans 'Change my data' %}
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="{% url 'user:my_tickets' user.pk %}">
                        {% trans 'My tickets' %}
                    </a>
                    {% if user.is_staff or user.is_superuser %}
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item"
                       href="{% url 'admin:statistics' %}">{% trans 'Admin panel' %}</a>
                    {% endif %}
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item text-danger"
                       href="{% url 'user:logout' %}">{% trans 'Logout' %}</a>
                  </div>
                </li>
            {% endif %}

              <li class="nav-item">
                  <ul class="navbar-nav">
                      {% get_current_language as LANGUAGE_CODE %}
                      {% get_available_languages as LANGUAGES %}
                      {% get_language_info_list for LANGUAGES as languages %}

                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle"
                             href="#"
                             id="langDropdown"
                             role="button"
                             data-toggle="dropdown"
                             aria-haspopup="true"
                             aria-expanded="false"><img src="/static/main/img/flags/png/{{LANGUAGE_CODE}}.png" class="mr-2" alt="">{% trans 'Language' %}<span class="caret"></span></a>

                          <div class="dropdown-menu dropdown-menu-right"
                               aria-labelledby="langDropdown"
                               role="menu" id="language-list">
                            {% for language in languages %}
                                  <a href="{% url 'set_language' %}" data-language-code="{{ language.code }}" class="dropdown-item">
                                    {% if language.code == LANGUAGE_CODE %}&#10003;{% else %}&nbsp;&nbsp;{% endif %}
                                    <img src="/static/main/img/flags/png/{{ language.code }}.png">
                                    {{ language.name_local }}
                                  </a>
                                {% if not forloop.last %}<div class="dropdown-divider"></div>{% endif %}
                            {% endfor %}
                          </div>
                      </li>
                  </ul>
              </li>
          </ul>
        </div>

      </div>
    </nav>

    <main class="container-fluid p-0">
      {% block content %}

      {% endblock %}
    </main>

    <footer class="mx-auto" style="width: 75vw; margin-top: 5vw;">
        <hr style="border-width: 2px; border-color: black">
        <div class="row justify-content-center mt-5">

            <div class="col-4 row ml-5">
                <a href="{% url 'main:mobile_applications' %}">
                    <h5>
                        {% trans 'Mobile applications' %}
                    </h5>
                </a>
                <div class="row my-3">
                    <a href="#" class="col ml-3">
                        <img src="{% static 'main/main_layout/img/mobile_applications/available_on_android.png' %}" alt="" style="width: 8vw;">
                    </a>
                    <a href="#" class="col">
                        <img src="{% static 'main/main_layout/img/mobile_applications/available_on_ios.png' %}" alt="" style="width: 8vw;">
                    </a>
                </div>
                <div class="col-12 mt-5">
                    <h5>
                        {% trans 'Websites development' %}: AVADA-MEDIA
                    </h5>
                </div>
            </div>

            <div class="col row">
                <a href="{% url 'main:poster' %}">
                   <h5 class="col-12">
                        {% trans 'Poster' %}
                    </h5>
                </a>
                <a href="{% url 'main:timetable' %}" class="col-12">
                    {% trans 'Timetable' %}
                </a>
                <a href="{% url 'main:soon' %}" class="col-12">
                    {% trans 'Soon' %}
                </a>
                <a href="{% url 'main:cinemas' %}" class="col-12">
                    {% trans 'Cinemas' %}
                </a>
                <a href="{% url 'main:promotion' %}" class="col-12">
                    {% trans 'Promotions' %}
                </a>
            </div>

            <div class="col row">
                <a href="{% url 'main:about_the_cinema' %}">
                   <h5 class="col-12">
                        {% trans 'About the cinema' %}
                    </h5>
                </a>
                <a href="{% url 'main:news' %}" class="col-12">
                    {% trans 'News' %}
                </a>
                <a href="{% url 'main:advertising' %}" class="col-12">
                    {% trans 'Advertising' %}
                </a>
                <a href="{% url 'main:cafe_bar' %}" class="col-12">
                    {% trans 'Cafe' %}
                </a>
                <a href="{% url 'main:contacts' %}" class="col-12">
                    {% trans 'Contacts' %}
                </a>
            </div>

            <div class="col-5 col-lg-3">
                <div class="nav social-links">
                    <a href="#"
                       title="Facebook">
                        <img class="link-height" src="{% static 'main/main_layout/img/social_icons/facebook.png' %}" alt="">
                    </a>
                    <a href="#"
                       title="Twitter">
                        <img class="link-height" src="{% static 'main/main_layout/img/social_icons/twitter.png' %}" alt="">
                    </a>
                    <a href="#"
                       title="{% trans 'Vkontakte' %}">
                        <img class="link-height" src="{% static 'main/main_layout/img/social_icons/vkontakte.png' %}" alt="">
                    </a>
                    <a href="#"
                       title="{% trans 'Odnoklassniki' %}">
                        <img class="link-height" src="{% static 'main/main_layout/img//social_icons/odnoklassniki.png' %}" alt="">
                    </a>
                </div>


            </div>
        </div>
        <div class="col text-center my-5">
            <h5>© CinemaCMS 2022, All rights reserved</h5>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
    <!-- Bootstrap 4 -->
    <script src="{% static 'dist/js/bootstrap.bundle.min.js' %}"></script>

    {# Language switch ajax code #}
    <script>
        $('#language-list a').on('click', function(event) {
            event.preventDefault();
            let target = $(event.target);
            let url = target.attr('href');
            let language_code = target.data('language-code');
            $.ajax({
                type: 'POST',
                url: url,
                data: {language: language_code},
                headers: {"X-CSRFToken": getCookie('csrftoken')}
            }).done(function(data, textStatus, jqXHR) {
                reload_page();
            });
        });


        function getCookie(name) {
            let value = '; ' + document.cookie,
                parts = value.split('; ' + name + '=');
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        function reload_page() {
            window.location.reload(true);
        }
    </script>

    {% block scripts %}

    {% endblock %}
  </body>
</html>
