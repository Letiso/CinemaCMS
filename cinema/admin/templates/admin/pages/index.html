{% extends 'admin/admin_layout.html' %}
{% load static %}

{% block stylesheets %}
{% endblock %}

{% block pages %}
    active
{% endblock %}

{% block current_page %}Страницы{% endblock %}

{% block path %}
    <li class="breadcrumb-item active">Страницы</li>
{% endblock %}

{% block content %}
    <!-- Main content -->
    <div class="card">
      <div id="data_table_decorator" class="card-body">
        <table id="pagesList" class="table table-bordered table-striped">
          <thead>
             <tr>
                <th>Название</th>
                <th>Дата создания</th>
                <th>Статус</th>
                <th>Редактировать</th>
             </tr>
          </thead>
          <tbody>
            <tr>
                <td>{{ main_page.title }}</td>
                <td>{{ main_page.date_created }}</td>
                <td>{% if main_page.is_active %}<span>Вкл.</span>{% else %}<span>Выкл.</span>{% endif %}</td>
                <td class="col-1">
                      <div class="row buttons">
                          <a href="{% url 'main_page_card' %}"
                             class="fas fa-pen text-primary mx-auto"></a>
                      </div>
                  </td>
            </tr>
            {% for page in primary_page_list %}
              <tr>
                  <td>{{ page.title }}</td>
                  <td>{{ page.date_created }}</td>
                  <td>
                      {% if page.is_active %}
                        <span>Вкл.</span>
                      {% else %}
                        <span>Выкл.</span>
                      {% endif %}</td>
                  <td class="col-1">
                      <div class="row buttons">
                          <a href="{% url 'page_card' page.pk %}"
                             class="fas fa-pen text-primary mx-auto"></a>
                      </div>
                  </td>
              </tr>
            {% endfor %}
            {% for page in custom_page_list %}
              <tr>
                  <td>{{ page.title }}</td>
                  <td>{{ page.date_created }}</td>
                  <td>
                      {% if page.is_active %}
                        <span>Вкл.</span>
                      {% else %}
                        <span>Выкл.</span>
                      {% endif %}</td>
                  <td class="col-1">
                      <div class="row buttons">
                          <a href="{% url 'page_card' page.pk %}"
                             class="fas fa-pen text-primary mx-auto"></a>
                          <!-- Button trigger modal -->
                          <a class="fas fa-minus-circle text-danger ml-2 mr-auto"
                             data-toggle="modal" data-target="#deleteUserModal-{{ forloop.counter }}"></a>
                          <!-- Modal -->
                        <div class="modal fade" id="deleteUserModal-{{ forloop.counter }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                          <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                              <div class="modal-header bg-dark">
                                <h5 class="modal-title" id="exampleModalLongTitle-{{ forloop.counter }}">
                                    Подтверждение удаления
                                </h5>
                              </div>
                              <div class="modal-body text-center bg-light" style="padding-top: 4vh; padding-bottom: 4vh;">
                                <span style="font-size: 20px;">
                                    Вы уверены, что хотите удалить эту новость?
                                </span>
                                <span class="text-primary" style="font-size: 35px;">
                                    {{ page.title }}
                                </span>
                              </div>
                              <div class="modal-footer bg-dark">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                    Назад
                                </button>
                                  <a href="{% url 'delete_page' page.pk %}" class="btn btn-danger">
                                      Удалить новость
                                  </a>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                  </td>
              </tr>
            {% endfor %}

            <tr>
                <td>Контакты</td>
                <td>{{ contacts_page.date_created }}</td>
                <td>{% if contacts_page.is_active %}<span>Вкл.</span>{% else %}<span>Выкл.</span>{% endif %}</td>
                <td class="col-1">
                      <div class="row buttons">
                          <a href="{% url 'contacts_page_card' %}"
                             class="fas fa-pen text-primary mx-auto"></a>
                      </div>
                  </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- /.card-body -->
    </div>
    <!-- /.card -->
    <!-- /.content -->

{% endblock %}

{% block scripts %}
<!-- DataTables  & Plugins -->
<script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
<script src="{% static 'admin/js/get_data_table.js' %}"></script>

<script>
    const dataTableId = "pagesList";
    getDataTable(dataTableId);

    function add_create_button(dataTable) {
        let left_header = document.getElementById(`${dataTable}_wrapper`).getElementsByClassName('col-sm-12')[0]
        left_header.innerHTML = `<a href="{% url 'page_card' 'new' %}" class="btn btn-primary mt-2 ml-3 px-2"><i class="fas fa-plus pr-2"></i>Создать страницу</a>`
        }

    add_create_button("pagesList");

</script>
{% endblock %}

